(()=>{"use strict";const e=function(e){let t,s,i,n;const o=(e=e||{}).delay||50;function l(){t=null,n=0}return l(),function(){return s=window.scrollY,null!==t&&(n=s-t),t=s,clearTimeout(i),i=setTimeout(l,o),console.log(n),parseInt(n)}}(),t=function(e,t){const s=t&&"local"!==t.toLowerCase()?sessionStorage:localStorage,i=function(t){s.setItem(e,JSON.stringify(t))},n=function(){return null!==s.getItem(e)};return Object.freeze({set:i,get:function(){return!!n()&&JSON.parse(s.getItem(e))},exists:n,create:function(){n()||i(arguments[0]||{})},remove:function(){s.removeItem(e)}})};class s{constructor(e){this.element=e,this.happened=!1,this.storageKey="popper-dismiss",this.oldScroll=null;const{settings:t,triggers:s}=this.element.dataset;if(this.settings=JSON.parse(t),this.triggers=s,s.includes("dismissForVisitors")&&this.isItemDismissed())return!1;this.element.addEventListener("close",(()=>this.addRemoveBodyMargin())),this.isMobile=window.matchMedia("only screen and (max-width: 767px)").matches,this.isTablet=window.matchMedia("(min-width:768px) and (max-width: 992px)").matches,this.checkDevice(),this.scrollBarWidth=Math.abs(window.innerWidth-document.documentElement.clientWidth)}init(){this.bindOpen(),this.bindClose()}openModal(e){this.closeModals();const{modal:t}=this.element.dataset;!t||this.element.classList.contains("is-style-top-bar")||this.element.classList.contains("is-style-bottom-bar")||this.element.classList.contains("is-style-off-canvas")||this.element.classList.contains("is-style-off-canvas-left")?this.element.show():this.element.showModal(),this.happened=!0,this.emitEvent(e,{id:this.element.dataset.id,type:e}),this.toggleBodyMargin(),this.addRemoveBodyMargin()}closeModals(){const e=document.querySelectorAll(".wp-block-popper");for(let t=0;t<e.length;t++)e[t].close(),this.addRemoveBodyMargin()}closeModal(){const e=this.element.getElementsByTagName("iframe"),t=this.element.getElementsByTagName("video"),s=this.element.getElementsByTagName("presto-player");for(const t of e){const e=t.src;t.src="",t.src=e,t.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),t.setAttribute("src",e)}for(const e of t)e.pause();for(const e of s)e.pause();this.addRemoveBodyMargin(),this.storeInCache(),this.element.close()}storeInCache(){const{triggers:e}=this.element.dataset;if(!e.includes("dismissForVisitors")||e.includes("anchor"))return;const t=new Date,s=JSON.parse(window.localStorage.getItem(this.storageKey))||[],i=s?.some((e=>e.modalID===this.element.id));if(i)return!1;const n=864e5*this.settings.dismissForVisitors.period,o={expiry:t.getTime()+n,modalID:this.element.id};window.localStorage.setItem(this.storageKey,JSON.stringify([...s,o]))}isItemDismissed(){const e=JSON.parse(window.localStorage.getItem(this.storageKey))||[],t=e.filter((e=>e.modalID===this.element.id));if(0===t.length)return!1;const s=t[0],i=new Date;if(s.expiry>i.getTime())return!0;const n=e.filter((e=>e!==t[0]));return window.localStorage.setItem(this.storageKey,JSON.stringify(n)),!1}checkDevice(){const{devices:e}=this.element.dataset;e&&(!e.includes("desktop")||this.isMobile||this.isTablet||this.init(),e.includes("tablet")&&this.isTablet&&this.init(),e.includes("mobile")&&this.isMobile&&this.init())}bindOpen(){const{triggers:e}=this.element.dataset;e.includes("anchor")&&this.bindAnchors(),e.includes("adBlock")&&this.bindAdBlock(),e.includes("pageviews")&&this.bindPageViews(),e.includes("target")&&this.bindTarget(),e.includes("scroll")&&this.bindOpenAfterScroll(),e.includes("exit")&&(this.bindExitIntent(),this.bindExitIntentMobile()),e.includes("timer")&&this.bindOnTimer(),e.includes("load")&&this.bindOnLoad(),this.bindClick()}bindAnchors(){const{anchor:e}=this.element.dataset;if(!e)return!1;document.querySelectorAll(`#${e}`).forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.openModal("anchor")}))}))}bindClick(){const{id:e}=this.element.dataset;window.addEventListener("click",(t=>{const{popper:s}=t.target.dataset;s===e&&(t.preventDefault(),this.openModal("click"))}))}bindOpenAfterScroll(){document.addEventListener("scroll",(()=>{if(this.happened)return!1;const e=this.settings.scroll.scrollPercent;if(Number(e)>=this.getScrolledPercent())return!1;this.openModal("scroll")}))}bindOnLoad(){if(this.happened)return!1;this.openModal("load")}bindOnTimer(){setTimeout((()=>{if(this.happened)return!1;this.openModal("load")}),1e3*this.settings.timer.time)}bindExitIntent(){document.addEventListener("mouseout",(e=>{if(this.happened)return!1;e.clientY<0&&this.openModal("exit")}))}bindExitIntentMobile(){if(!this.isMobile)return!1;window.addEventListener("scroll",(()=>{setTimeout((()=>{-1*e()>50&&!this.happened&&this.openModal("exit")}),5e3)}))}bindAdBlock(){this.isAdBlocked((e=>{if(!e)return!1;window.addEventListener("scroll",(()=>{if(this.happened)return!1;const e=this.settings.adBlock.scrollPercent;if(Number(e||50)>=this.getScrolledPercent())return!1;this.openModal("adblock")}))}))}bindTarget(){const{target:e}=this.element.dataset;window.onscroll=()=>this.isScrolledIntoView(e)}bindPageViews(){document.addEventListener("DOMContentLoaded",this.hitcounter())}bindClose(){this.bindCloseButtons(),this.bindAnchorClose(),this.bindOverlayClosing(),this.bindFormClosing(),this.bindEscClosing()}bindAnchorClose(){if(!this.settings.closeAnchor)return!1;document.querySelectorAll(`#${this.settings.closeAnchor.target}`).forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.closeModal()}))}))}bindCloseButtons(){this.element.querySelectorAll(".wp-block-popper__close, .close-popper > .wp-element-button").forEach((e=>{e.addEventListener("click",(()=>{this.closeModal()}))}))}bindOverlayClosing(){const{triggers:e}=this.element.dataset;if(!e.includes("closeOnClickOutside"))return!1;this.element.addEventListener("click",(({target:e})=>{"DIALOG"===e.nodeName&&this.closeModal()}))}bindEscClosing(){window.addEventListener("keydown",(e=>{27===e.keyCode&&this.closeModal()}))}bindFormClosing(){const{triggers:e}=this.element.dataset;if(!e.includes("closeOnFormSubmission"))return!1;["formello-success","popper-form-success","fluentform_submission_success"].forEach((e=>{window.addEventListener(e,(()=>{setTimeout((()=>{this.closeModal()}),1e3)}))}))}isScrolledIntoView(e){const t=document.getElementById(e);if(!t)return!1;const s=t.getBoundingClientRect(),i=s.top,n=s.bottom;i>=0&&n<=window.innerHeight&&this.openModal("scroll")}getScrolledPercent(){const e=document.documentElement,t=document.body,s="scrollTop",i="scrollHeight";return(e[s]||t[s])/((e[i]||t[i])-e.clientHeight)*100}hitcounter(){const e=new t("urls","sessionStorage");e.create();const s=e.get();s[window.location.href]=s.hasOwnProperty(window.location.href)?parseInt(s[window.location.href])+1:1,s.total=s.hasOwnProperty("total")?parseInt(s.total)+1:1;const{pagenum:i}=this.element.dataset;s.total>=i&&this.openModal("pageviews"),e.set(s)}isAdBlocked(e){const t=`https://ads.google.com?=${(new Date).getTime()}`;fetch(t,{mode:"no-cors",method:"HEAD"}).then((t=>{e(t.redirected)})).catch((()=>{e(!0)}))}emitEvent(e,t){window.dispatchEvent(new CustomEvent("popper-"+e,{detail:t})),this.element.dispatchEvent(new CustomEvent("popper-"+e,{detail:t}))}toggleBodyMargin=()=>{this.element.classList.contains("is-style-top-bar")&&window.addEventListener("scroll",(()=>this.addRemoveBodyMargin()))};addRemoveBodyMargin=()=>{if(!this.element.classList.contains("is-style-top-bar"))return;const e=this.element.hasAttribute("open");e&&window.scrollY<this.element.offsetHeight&&(document.body.style.marginTop=this.element.offsetHeight+"px",document.body.style.transition="margin 400ms"),e||(document.body.style.marginTop="")}}document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".wp-block-popper");e.length&&e.forEach((e=>{new s(e)}))}))})();